---
globs: *.ts,*.tsx,*.js,*.jsx,*.json,*.md
description: é‡å°ä¸åŒæª”æ¡ˆé¡å‹çš„å°ˆé–€é–‹ç™¼è¦ç¯„
---

# æª”æ¡ˆç‰¹å®šè¦ç¯„

## TypeScript/JavaScript æª”æ¡ˆ (_.ts, _.tsx, _.js, _.jsx)

### ğŸ“ æª”æ¡ˆé ­éƒ¨è¨»è§£

```typescript
// ABOUTME: æ­¤æª”æ¡ˆè² è²¬æŠ•å½±ç‰‡ç·¨è¼¯å™¨çš„ä¸»è¦å®¹å™¨åŠŸèƒ½
// ABOUTME: æ•´åˆå·¥å…·åˆ—ã€ç·¨è¼¯å€åŸŸå’Œç‹€æ…‹åˆ—ï¼Œç®¡ç†çµ±è¨ˆè¨ˆç®—å’Œæ ¼å¼åŒ–æ“ä½œ
```

**å¼·åˆ¶è¦æ±‚**ï¼šæ¯å€‹æª”æ¡ˆéƒ½å¿…é ˆä»¥å…©è¡Œ `// ABOUTME:` é–‹é ­çš„è¨»è§£

### ğŸ”§ åŒ¯å…¥è¦ç¯„

```typescript
// 1. Node æ¨¡çµ„
import React from 'react';
import { useState, useCallback } from 'react';

// 2. ç¬¬ä¸‰æ–¹å‡½å¼åº«
import { create } from 'zustand';
import { cn } from 'clsx';

// 3. å…§éƒ¨æ¨¡çµ„ (ä½¿ç”¨ @ åˆ¥å)
import { Button } from '@/components/ui/button';
import { useEditorStore } from '@/store/editorStore';
import type { EditorProps } from '@/types/editor';

// 4. ç›¸å°è·¯å¾‘åŒ¯å…¥
import { EditorToolbar } from './EditorToolbar';
import { EditorStatusBar } from './EditorStatusBar';
```

### ğŸ·ï¸ åŒ¯å‡ºè¦ç¯„

```typescript
// å…·ååŒ¯å‡º (é¦–é¸)
export function EditorPanel() {
  /* ... */
}
export { EditorPanel };

// å‹åˆ¥åŒ¯å‡º
export type { EditorPanelProps };

// é è¨­åŒ¯å‡º (åƒ…ç•¶æ˜¯ä¸»è¦å…ƒä»¶æ™‚)
export default EditorPanel;
```

### ğŸ¯ å‹åˆ¥è¨»è§£

```typescript
// æ˜ç¢ºçš„å‹åˆ¥è¨»è§£
const handleChange = (content: string): void => {
  // å¯¦ä½œ
};

// æ³›å‹ä½¿ç”¨
function createStore<T>(initialState: T): Store<T> {
  // å¯¦ä½œ
}

// é¿å… anyï¼Œä½¿ç”¨ unknown
function parseData(data: unknown): ParsedData {
  // å¯¦ä½œ
}
```

## React å…ƒä»¶æª”æ¡ˆ (\*.tsx)

### ğŸ§© å…ƒä»¶çµæ§‹é †åº

```typescript
// ABOUTME: æŠ•å½±ç‰‡é è¦½å…ƒä»¶ï¼Œé¡¯ç¤º Marp æ¸²æŸ“å¾Œçš„æŠ•å½±ç‰‡å…§å®¹
// ABOUTME: æ”¯æ´ç¸®æ”¾ã€å°èˆªå’Œå…¨è¢å¹•æ¨¡å¼åŠŸèƒ½

import React from 'react';
// ... å…¶ä»–åŒ¯å…¥

// 1. å‹åˆ¥å®šç¾©
interface SlidePreviewProps {
  content: string;
  className?: string;
}

// 2. ä¸»è¦å…ƒä»¶
export function SlidePreview({
  content,
  className
}: SlidePreviewProps) {
  // 3. Hook èª¿ç”¨
  const [isLoading, setIsLoading] = useState(false);
  const { render } = useMarpRenderer();

  // 4. äº‹ä»¶è™•ç†å™¨
  const handleContentChange = useCallback((newContent: string) => {
    // å¯¦ä½œ
  }, []);

  // 5. å‰¯ä½œç”¨
  useEffect(() => {
    // å¯¦ä½œ
  }, [content]);

  // 6. æ¸²æŸ“é‚è¼¯
  if (isLoading) {
    return <LoadingSpinner />;
  }

  return (
    <div className={cn('slide-preview', className)}>
      {/* JSX å…§å®¹ */}
    </div>
  );
}

// 7. è¨˜æ†¶åŒ– (å¦‚æœéœ€è¦)
export default React.memo(SlidePreview);
```

### ğŸ¨ æ¨£å¼è™•ç†

```typescript
// ä½¿ç”¨ cn å‡½æ•¸åˆä½µé¡å
className={cn(
  'base-classes',
  'conditional-classes',
  variant === 'primary' && 'primary-styles',
  disabled && 'disabled-styles',
  className
)}

// é¿å…å…§è¯æ¨£å¼ï¼Œä½¿ç”¨ Tailwind
<div className="flex items-center gap-2 p-4 bg-white dark:bg-gray-900">
```

## Hook æª”æ¡ˆ (\*.ts)

### ğŸª Hook å‘½åè¦ç¯„

```typescript
// ABOUTME: æ­¤ Hook æä¾›æŠ•å½±ç‰‡å°èˆªå’Œæ§åˆ¶åŠŸèƒ½
// ABOUTME: åŒ…å«ç¸®æ”¾ã€å…¨è¢å¹•ã€éµç›¤å¿«æ·éµå’Œå°èˆªç‹€æ…‹ç®¡ç†

// Hook åç¨±å¿…é ˆä»¥ use é–‹é ­
export function useSlideControls() {
  /* ... */
}
export function useMarpRenderer() {
  /* ... */
}
export function useAutoSave() {
  /* ... */
}

// å›å‚³å‹åˆ¥æ˜ç¢ºå®šç¾©
interface UseSlideControlsReturn {
  currentSlide: number;
  totalSlides: number;
  goToSlide: (index: number) => void;
  nextSlide: () => void;
  previousSlide: () => void;
  toggleFullscreen: () => void;
}
```

### âš™ï¸ Hook åƒæ•¸è¨­è¨ˆ

```typescript
// ä½¿ç”¨é¸é …ç‰©ä»¶å‚³éåƒæ•¸
interface UseAutoSaveOptions {
  interval?: number;
  key?: string;
  immediate?: boolean;
  validate?: (content: string) => boolean;
}

export function useAutoSave(content: string, options: UseAutoSaveOptions = {}) {
  const {
    interval = 30000,
    key = 'auto-save',
    immediate = false,
    validate = () => true,
  } = options;

  // Hook å¯¦ä½œ
}
```

## æ¸¬è©¦æª”æ¡ˆ (_.test.ts, _.test.tsx, \*.spec.ts)

### ğŸ§ª æ¸¬è©¦æª”æ¡ˆçµæ§‹

```typescript
// ABOUTME: æ­¤æª”æ¡ˆæ¸¬è©¦ Button å…ƒä»¶çš„å„ç¨®è®Šé«”å’Œäº’å‹•è¡Œç‚º
// ABOUTME: åŒ…å«å¯å­˜å–æ€§ã€é»æ“Šäº‹ä»¶å’Œæ¨£å¼è®Šé«”çš„æ¸¬è©¦æ¡ˆä¾‹

import { render, screen, fireEvent } from '@testing-library/react';
import { Button } from './button';

// ä½¿ç”¨ describe ç¾¤çµ„åŒ–æ¸¬è©¦
describe('Button', () => {
  // åŸºç¤æ¸²æŸ“æ¸¬è©¦
  describe('æ¸²æŸ“è¡Œç‚º', () => {
    it('should render with default props', () => {
      render(<Button>Test</Button>);
      expect(screen.getByRole('button')).toBeInTheDocument();
    });

    it('should apply custom className', () => {
      render(<Button className="custom-class">Test</Button>);
      expect(screen.getByRole('button')).toHaveClass('custom-class');
    });
  });

  // äº’å‹•æ¸¬è©¦
  describe('äº’å‹•è¡Œç‚º', () => {
    it('should handle click events', () => {
      const handleClick = vi.fn();
      render(<Button onClick={handleClick}>Test</Button>);

      fireEvent.click(screen.getByRole('button'));
      expect(handleClick).toHaveBeenCalledTimes(1);
    });
  });

  // å¯å­˜å–æ€§æ¸¬è©¦
  describe('å¯å­˜å–æ€§', () => {
    it('should have proper ARIA attributes', () => {
      render(<Button disabled>Test</Button>);
      expect(screen.getByRole('button')).toHaveAttribute('aria-disabled', 'true');
    });
  });
});
```

### ğŸ¯ æ¸¬è©¦å‘½åè¦ç¯„

```typescript
// æè¿°æ€§æ¸¬è©¦åç¨±
it('should render markdown as HTML slides', () => {});
it('should handle navigation between slides', () => {});
it('should display error message when rendering fails', () => {});
it('should save content to localStorage on change', () => {});

// Hook æ¸¬è©¦
describe('useMarpRenderer', () => {
  it('should return render result after successful rendering', () => {});
  it('should handle rendering errors gracefully', () => {});
  it('should debounce render calls', () => {});
});
```

## é…ç½®æª”æ¡ˆ (_.json, _.config.ts)

### âš™ï¸ package.json çµæ§‹

```json
{
  "name": "markdown-slides",
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "test": "vitest run --reporter=verbose",
    "test:e2e": "playwright test"
  },
  "dependencies": {
    "next": "15.4.5",
    "react": "19.1.0"
  }
}
```

### ğŸ”§ TypeScript é…ç½®æª”æ¡ˆ

```typescript
// tsconfig.json, next.config.ts ç­‰
// ä½¿ç”¨ satisfies ç¢ºä¿å‹åˆ¥å®‰å…¨
export default {
  experimental: {
    typedRoutes: true,
  },
} satisfies NextConfig;
```

## Markdown æª”æ¡ˆ (\*.md)

### ğŸ“– æ–‡ä»¶çµæ§‹è¦ç¯„

````markdown
# æ¨™é¡Œ

> ğŸ“‹ **æ–‡ä»¶ç›®çš„**ï¼šç°¡çŸ­æè¿°æ–‡ä»¶çš„ç›®çš„å’Œè®€è€…

## ä¸»è¦ç« ç¯€

### å­ç« ç¯€

- ä½¿ç”¨æ¸…æ™°çš„å±¤ç´šçµæ§‹
- æä¾›ç¨‹å¼ç¢¼ç¯„ä¾‹
- åŒ…å«ç›¸é—œæª”æ¡ˆé€£çµ

```typescript
// ç¨‹å¼ç¢¼ç¯„ä¾‹æ‡‰è©²æœ‰èªæ³•é«˜äº®
function example() {
  return 'Hello World';
}
```
````

## åƒè€ƒè³‡æ–™

- [ç›¸é—œæ–‡ä»¶](./related-doc.md)
- [API åƒè€ƒ](./api-reference.md)

````

### ğŸ“ ç¨‹å¼ç¢¼å€å¡Šè¦ç¯„
```markdown
<!-- æŒ‡å®šèªè¨€ä»¥å•Ÿç”¨èªæ³•é«˜äº® -->
```typescript
interface Example {
  name: string;
}
````

<!-- åŒ…å«æª”æ¡ˆè·¯å¾‘ä½œç‚ºè¨»è§£ -->

```typescript
// src/components/Example.tsx
export function Example() {
  return <div>Example</div>;
}
```

````

## æ¨£å¼æª”æ¡ˆ (*.css, globals.css)

### ğŸ¨ CSS è®Šæ•¸è¦ç¯„
```css
/* ABOUTME: å…¨åŸŸæ¨£å¼å®šç¾©ï¼ŒåŒ…å« CSS è®Šæ•¸å’ŒåŸºç¤æ¨£å¼ */
/* ABOUTME: æ”¯æ´äº®è‰²å’Œæš—è‰²ä¸»é¡Œçš„è®Šæ•¸å®šç¾© */

:root {
  /* ä¸»è¦é¡è‰²è®Šæ•¸ */
  --background: 0 0% 100%;
  --foreground: 222.2 84% 4.9%;
  --primary: 222.2 47.4% 11.2%;

  /* é–“è·è®Šæ•¸ */
  --spacing-xs: 0.25rem;
  --spacing-sm: 0.5rem;
  --spacing-md: 1rem;
}

.dark {
  --background: 222.2 84% 4.9%;
  --foreground: 210 40% 98%;
}
````

### ğŸ—ï¸ å…ƒä»¶æ¨£å¼

```css
/* ä½¿ç”¨ BEM å‘½åæ³•æˆ– Tailwind é¡å */
.slide-preview {
  @apply flex flex-col h-full overflow-hidden;
}

.slide-preview__content {
  @apply flex-1 overflow-auto;
}

.slide-preview--loading {
  @apply opacity-50 pointer-events-none;
}
```

## ç’°å¢ƒæª”æ¡ˆ (.env, .env.local)

### ğŸ” ç’°å¢ƒè®Šæ•¸è¦ç¯„

```bash
# ABOUTME: é–‹ç™¼ç’°å¢ƒè®Šæ•¸é…ç½®
# ABOUTME: åŒ…å« API é‡‘é‘°å’Œæœå‹™ç«¯é»è¨­å®š

# Next.js å…¬é–‹è®Šæ•¸ (NEXT_PUBLIC_ å‰ç¶´)
NEXT_PUBLIC_APP_NAME=Markdown Slides
NEXT_PUBLIC_API_URL=http://localhost:3000/api

# ç§æœ‰è®Šæ•¸ (ä¼ºæœå™¨ç«¯ä½¿ç”¨)
OPENAI_API_KEY=your-api-key-here
DATABASE_URL=postgres://user:pass@localhost:5432/db

# åŠŸèƒ½é–‹é—œ
NEXT_PUBLIC_ENABLE_ANALYTICS=false
```

åƒè€ƒé‡è¦æª”æ¡ˆï¼š

- [å°ˆæ¡ˆæ¶æ§‹æ–‡ä»¶](mdc:docs/project-architecture-for-ai.md)
- [å‹åˆ¥å®šç¾©](mdc:src/types/index.ts)
- [Vitest é…ç½®](mdc:vitest.config.ts)
- [Next.js é…ç½®](mdc:next.config.ts)
